<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="egovframework.user.service.impl.ServiceUserMapper">
  
  <select id="duplicatedEmailCheck" parameterType="hashMap" resultType="int">
  	/* 서비스 사용자 이메일 중복검사, serviceUser_SQL.duplicatedEmailCheck */
  	SELECT COUNT(*) FROM SERVICE_USER
  	WHERE EMAIL = #{email}
  </select>
  
   <select id="duplicatedNicknameCheck" parameterType="hashMap" resultType="int">
  	/* 서비스 사용자 닉네임 중복검사, serviceUser_SQL.duplicatedNicknameCheck */
  	SELECT COUNT(*) FROM SERVICE_USER
  	WHERE NICKNAME = #{nickname}
  </select>
  
  <insert id="signUpUser" parameterType="SignUpVO">
    <selectKey resultType="long" keyProperty="seq" order="BEFORE">
    	SELECT COALESCE(MAX(SEQ), 0)+1 FROM SERVICE_USER
    </selectKey>
    /* 서비스 사용자 회원가입, serviceUser_SQL.signUpUser */
  	INSERT INTO SERVICE_USER (
  		  SEQ
  		, NICKNAME
  		, EMAIL
  		, PASSWORD
  		, SALT
  		, NAME
  		, TEL
  		, GENDER
  		, CITY
  		, GRADE
  		, PWD_UPD_DT
  		, JOIN_DT
  	) VALUES (
  	      #{seq}
  		, #{nickname}
  		, #{email}
  		, #{password}
  		, #{salt}
  		, #{name}
  		, #{tel}
  		, #{gender}
  		, #{city}
  		, 'COM0000010'
  		, CURRENT_TIMESTAMP
  		, CURRENT_TIMESTAMP
  	)
  </insert>
  
</mapper>