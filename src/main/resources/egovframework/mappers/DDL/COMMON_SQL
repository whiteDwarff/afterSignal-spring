-- 공통코드 테이블 생성 
CREATE TABLE COM_CODE (
    SEQ SERIAL   UNIQUE
  , GROUP_CODE   VARCHAR(50)    NOT NULL
  , CODE         VARCHAR(50)	NOT NULL
  , CODE_NAME    VARCHAR(100)	NOT NULL
  , SORT         INT4	
  , USE_YN 		 CHAR(1)		DEFAULT 'Y'
  , ETC          TEXT
  , INS_ID  	 VARCHAR(20)
  , INS_DT       VARCHAR(14)
  , UPD_ID  	 VARCHAR(20)
  , UPD_DT       VARCHAR(14)
  , CONSTRAINT COM_CODE_GROUP_PK PRIMARY KEY(GROUP_CODE, CODE)
);
COMMENT ON TABLE COM_CODE 			   IS '공통코드';

COMMENT ON COLUMN COM_CODE.SEQ 		   IS '시퀀스';
COMMENT ON COLUMN COM_CODE.GROUP_CODE  IS '그룹코드';
COMMENT ON COLUMN COM_CODE.CODE        IS '구분코드';
COMMENT ON COLUMN COM_CODE.CODE_NAME   IS '코드명';
COMMENT ON COLUMN COM_CODE.SORT        IS '순번';
COMMENT ON COLUMN COM_CODE.USE_YN      IS '사용여부';
COMMENT ON COLUMN COM_CODE.ETC         IS '설명';
COMMENT ON COLUMN COM_CODE.INS_ID      IS '등록자';
COMMENT ON COLUMN COM_CODE.INS_DT      IS '등록일시';
COMMENT ON COLUMN COM_CODE.UPD_ID      IS '수정자';
COMMENT ON COLUMN COM_CODE.UPD_DT      IS '수정일시';

----------------------------------------------------
DROP TABLE SERVICE_USER;
-- 서비스 사용자 테이블 생성
CREATE TABLE SERVICE_USER (
	SEQ 	 	  VARCHAR(15)    PRIMARY KEY 
  , NICKNAME 	  VARCHAR(20)    UNIQUE NOT NULL
  , EMAIL 	 	  VARCHAR(254)   NOT NULL 
  , PASSWORD 	  CHAR(64) 	     NOT NULL
  , SALT	 	  BYTEA 		 NOT NULL
  , NAME 	 	  VARCHAR(20)    NOT NULL
  , TEL      	  VARCHAR(13)    NOT NULL
  , CITY     	  VARCHAR(10)
  , DISTRICT 	  VARCHAR(10)
  , GRADE    	  VARCHAR(10)
  , DEPOSIT  	  NUMERIC(15, 0) DEFAULT 0
  , AMOUNT 		  NUMERIC(15, 0) DEFAULT 0 
  , DEL_YN        CHAR(1)        DEFAULT 'N'
  , PWD_UPD_DT 	  VARCHAR(14)
  , LAST_LOGIN_DT VARCHAR(14)
  , JOIN_DT		  VARCHAR(14)
);
COMMENT ON TABLE SERVICE_USER 			      IS '서비스 사용자';

COMMENT ON COLUMN SERVICE_USER.SEQ 		      IS '시퀀스';  -- SV / 가입년도 / 시(도)명 / LPAD 5자리 
COMMENT ON COLUMN SERVICE_USER.NICKNAME       IS '닉네임';
COMMENT ON COLUMN SERVICE_USER.EMAIL 	      IS '이메일';
COMMENT ON COLUMN SERVICE_USER.PASSWORD       IS '비밀번호';
COMMENT ON COLUMN SERVICE_USER.SALT 	      IS 'SALT BYTE';
COMMENT ON COLUMN SERVICE_USER.NAME 	      IS '이름';
COMMENT ON COLUMN SERVICE_USER.TEL 	          IS '전화번호';
COMMENT ON COLUMN SERVICE_USER.CITY 	      IS '시(도)';
COMMENT ON COLUMN SERVICE_USER.DISTRICT       IS '구';
COMMENT ON COLUMN SERVICE_USER.GRADE          IS '등급';
COMMENT ON COLUMN SERVICE_USER.DEPOSIT        IS '적립금';
COMMENT ON COLUMN SERVICE_USER.AMOUNT         IS '캐';
COMMENT ON COLUMN SERVICE_USER.DEL_YN         IS '탈퇴여부';
COMMENT ON COLUMN SERVICE_USER.PWD_UPD_DT     IS '비밀번호 변경일';
COMMENT ON COLUMN SERVICE_USER.LAST_LOGIN_DT  IS '마지막 로그인 일자';
COMMENT ON COLUMN SERVICE_USER.JOIN_DT        IS '가입일';

----------------------------------------------------
DROP TABLE SERVICE_USER_AMOUNT_HISTORY;
-- 서비스 사용자 포인트 변경 히스토리 테이블 생성
CREATE TABLE SERVICE_USER_POINT_HISTORY (
	 USER_SEQ 	   VARCHAR(15)  
   , CHANGE_REASON VARCHAR(100)
   , BEFORE_POINT  NUMERIC(15, 0)
   , USAGE_POINT   NUMERIC(15, 0)
   , TOTAL_POINT   NUMERIC(15, 0)
   , USAGE_DATE    VARCHAR(14)
   , STATUS        VARCHAR(10)
   , PAYMENT 	   VARCHAR(10)
   , FOREIGN KEY (USER_SEQ) REFERENCES SERVICE_USER(SEQ)
);
COMMENT ON TABLE SERVICE_USER_POINT_HISTORY                 IS '서비스 사용자 포인트 변경 히스토리';

COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.USER_SEQ 	    IS '시퀀스'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.CHANGE_REASON 	IS '변경사유'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.BEFORE_POINT 	IS '사용 전 금액'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.USAGE_POINT 	IS '사용 금액'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.TOTAL_POINT 	IS '누적 금액'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.USAGE_DATE 	IS '변경 일자'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.STATUS 	    IS '변경 상태'; 
COMMENT ON COLUMN SERVICE_USER_POINT_HISTORY.PAYMENT 	    IS '결제 수단'; 


----------------------------------------------------
DROP TABLE SERVICE_USER_DEPOSIT_HISTORY;
-- 서비스 사용자 적립금 변경 히스토리 테이블 생성
CREATE TABLE SERVICE_USER_DEPOSIT_HISTORY (
	 USER_SEQ 	    VARCHAR(15)  
   , CHANGE_REASON  VARCHAR(100)
   , BEFORE_DEPOSIT NUMERIC(15, 0)
   , USAGE_DEPOSIT  NUMERIC(15, 0)
   , TOTAL_DEPOSIT  NUMERIC(15, 0)
   , USAGE_DATE     VARCHAR(14)
   , STATUS         VARCHAR(10)
   , FOREIGN KEY (USER_SEQ) REFERENCES SERVICE_USER(SEQ)
);
COMMENT ON TABLE SERVICE_USER_DEPOSIT_HISTORY                  IS '서비스 사용자 적립금 변경 히스토리';

COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.USER_SEQ 	   IS '시퀀스'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.CHANGE_REASON   IS '변경사유'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.BEFORE_DEPOSIT  IS '사용 전 금액'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.USAGE_DEPOSIT   IS '사용 금액'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.TOTAL_DEPOSIT   IS '누적 금액'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.USAGE_DATE 	   IS '변경 일자'; 
COMMENT ON COLUMN SERVICE_USER_DEPOSIT_HISTORY.STATUS 	       IS '변경 상태'; 
